#!/bin/bash

echo "compile in progress ..."

BUILD_DIR=${1:-}
CACHE_DIR=${2:-}
ENV_DIR=${3:-}

echo "BUILD_DIR: $BUILD_DIR"
echo "CACHE_DIR: $CACHE_DIR"
echo "ENV_DIR: $ENV_DIR"

echo "-----> Install cargo"
curl https://sh.rustup.rs -sSf > rustup.sh
chmod u+x rustup.sh
./rustup.sh -y

CARGO=~/.cargo/bin/cargo
$CARGO --version

echo "-----> Compile the application"
cd "$BUILD_DIR" && $CARGO build --release
